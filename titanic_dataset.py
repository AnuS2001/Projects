# -*- coding: utf-8 -*-
"""Titanic Dataset.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1fGahlMF9WOmCoAL9Su7NQxdxc9IEtIUF
"""

# Commented out IPython magic to ensure Python compatibility.
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
# %matplotlib inline
import seaborn as sns

df=pd.read_csv('/content/titanic_train.csv')

df.head()

df.info()

df['Sex'].unique()

df['Embarked'].unique()

gender=pd.get_dummies(df['Sex'],drop_first=True)
gender

embarked=pd.get_dummies(df['Embarked'],drop_first=True)
embarked

df.drop(['Sex','Embarked'],axis=1,inplace=True)

df=pd.concat([df,gender,embarked],axis=1)
df.head()

df['Age'].isnull().sum()

df['Pclass'].unique()

x=df.groupby('Pclass')['Age'].mean()
val=list(x)
print(val)

def compute_na(col):
  Age=col[0]
  Pclass=col[1]
  if pd.isnull(Age):
    if Pclass==1:
      return val[0]
    elif Pclass==2:
      return val[1]
    else:
      return val[2]
  else:
    return Age

df["Age"]=df[['Age','Pclass']].apply(compute_na,axis=1)

df.drop(['Cabin','Ticket','Name','PassengerId'],axis=1,inplace=True)

df.head(10)

df.corr()

sns.scatterplot(df.corr())
plt.title('Correlation')

plt.hist('Survived',data=df,color='b')

from sklearn.model_selection import train_test_split

x_train,x_test,y_train,y_test=train_test_split(df.drop('Survived',axis=1),df['Survived'],test_size=0.30,random_state=70)

x_train.shape

x_test.shape

from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score,confusion_matrix
lr=LogisticRegression()
lr.fit(x_train,y_train)
lr_pred=lr.predict(x_test)
print("Accuracy_Score:",accuracy_score(y_test,lr_pred)*100)
print("Confuion_matrix:\n",confusion_matrix(y_test,lr_pred))

